<%= render :partial => "admin_messages_tool.html.haml"%>
<h1>Send emails</h1>
<br />


<% if flash[:success] %>
    <%= flash[:success] %>
<% end %>

<%= form_for @message, :url=>admin_messages_create_email_path do |e| %>

    <% if @message.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@message.errors.count, "error") %> prohibited this hop_task from being saved:</h2>

          <ul>
            <% @message.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
    <% end %>

<table>
  <tr>
    <td class ="span4">Filters</td>
    <td class ="span4">Hop</td>
    <td class ="span4">Zip code</td>
    <td class ="span4">User id</td>
  </tr>
  <tr>
    <td></td>
    <td><%= text_field_tag :receiver_id ,'' ,:class=>"input-mini", onclick:"$('#myModalhop').modal()"%></td>
    <td><%= text_field_tag :receiver_id, '' , :class=>"input-mini", onclick:"$('#myModalzip').modal()" %></td>
    <td><%= text_field_tag :receiver_id,'' , :class=>"input-mini" ,  onclick:"$('#myModal').modal()" %></td>


  </tr>
</table>
    <%= select_tag  'users_id[]', options_from_collection_for_select(@users, "id","user_name"), id: 'e9',multiple:true, class:"populate select2-offscreen",
                     :tabindex=>"-1" %>




<table>
  <tr>
    <td class="span5"><%= e.radio_button :template,"temp1", :checked => true %>Temp 1 <%= e.radio_button :template, "temp2" %>Temp 2  <%= e.radio_button :template, "temp3" %>Temp 3</td>
    <td><%= e.text_field :subject, :class=>"input-xlarge", :placeholder=>"SABJECT LINE" %></td>
  </tr>
  <tr>
    <td><%= e.select :email_author, ['HOPMASTER@CashHoppers.com',current_user.email],:class=>"input-medium",  :placeholder=>"SEND FROM" %></td>
    <td></td>
  </tr>
  <tr>
    <td><%= e.file_field :file, :class=>"input-medium",  :placeholder=>"ATTACHE FILE" %></td>
    <td></td>
  </tr>
  <tr>
    <td></td>
    <td><%= e.text_area :text, :class=>"input-xlarge",  :placeholder=>"CONTENT", :rows=>"10" %></td>
  </tr>
  <tr>
    <td><%= e.submit "SEND", :class=>"input-medium btn btn-success" %></td>
  </tr>
</table>
<% end %>

<div class="pull-right"><%= link_to  "Email history", admin_messages_email_history_path%></div>

<%= link_to "Find hopper", admin_hoppers_search_hopper_path %>|
<%= link_to "Hopper list", admin_hoppers_search_hoppers_path %>


<div class="modal hide fade in" id="myModal" tabindex="-1" role="dialog" style="display: none;" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header" >

  </div>
  <div class="modal-body">
    <div id="myModal" class="example cursor">

      <%= render partial: "users_list" %>
    </div>
  </div>
  <div class="modal-footer">

  </div>
</div>


<div class="modal hide fade in" id="myModalzip" tabindex="-1" role="dialog" style="display: none;" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header" >

  </div>
  <div class="modal-body">
    <div id="myModalzip" class="example cursor">

      <%= render partial: "zips_list" %>
    </div>
  </div>
  <div class="modal-footer">

  </div>
</div>

<div class="modal hide fade in" id="myModalhop" tabindex="-1" role="dialog" style="display: none;" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header" >

  </div>
  <div class="modal-body">
    <div id="myModalhop" class="example cursor">

      <%= render partial: "hops_list" %>
    </div>
  </div>
  <div class="modal-footer">

  </div>
</div>
